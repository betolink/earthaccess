# earthaccess 1.0.0a1 Release Notes

**Release Date:** January 6, 2026

This is the first alpha release of earthaccess 1.0, representing a major milestone
in the library's evolution. This release introduces significant architectural
improvements, new features, and enhanced developer experience while maintaining
backward compatibility with the existing public API.

## Highlights

- **Modular Package Structure** - Complete reorganization into logical sub-packages
- **New Query Builders** - Type-safe, validated query construction with method chaining
- **Rich Display** - Jupyter notebook HTML rendering for search results
- **Interactive Maps** - Lonboard-powered spatial visualization
- **STAC Interoperability** - Bidirectional CMR/STAC format conversion
- **Cloud Storage Downloads** - Download directly to S3, GCS, or Azure
- **Virtual Datasets** - Multi-parser VirtualiZarr support (DMR++, HDF5, NetCDF3)
- **Lazy Pagination** - Memory-efficient iteration over large result sets

---

## Breaking Changes

### 1. Package Structure Reorganization

The internal package structure has been reorganized into modular sub-packages:

| Old Location | New Location |
|--------------|--------------|
| `earthaccess.query` | `earthaccess.search` |
| `earthaccess.daac` | `earthaccess.store.daac` |
| `earthaccess.results` | `earthaccess.search.results` |

**Important:** The top-level public API remains unchanged. You can still use:

```python
import earthaccess

earthaccess.login()
earthaccess.search_data(short_name="ATL06")
earthaccess.download(granules, "./data")
```

### 2. Removed Automatic Login Behavior

Previously, earthaccess would automatically log in users if credentials were
available in environment variables or `.netrc`. This undocumented behavior has
been removed.

**Before (implicit, no longer works):**
```python
import earthaccess
# Would auto-login if EARTHDATA_USERNAME/PASSWORD set
granules = earthaccess.search_data(short_name="ATL06")
files = earthaccess.open(granules)  # Might fail silently
```

**After (explicit, required):**
```python
import earthaccess
earthaccess.login()  # Explicit login required
granules = earthaccess.search_data(short_name="ATL06")
files = earthaccess.open(granules)  # Works reliably
```

### 3. SearchResults `len()` Behavior Change

The `len()` function on `SearchResults` now returns the count of loaded/cached
results, not the total CMR hits:

**Before:**
```python
results = earthaccess.search_data(short_name="ATL06", count=10)
len(results)  # Returned total CMR hits (e.g., 50000)
```

**After:**
```python
results = earthaccess.search_data(short_name="ATL06", count=10)
len(results)       # Returns loaded count (e.g., 10)
results.total()    # Returns total CMR hits (e.g., 50000)
```

This change makes `SearchResults` behave more like a standard Python sequence.

### 4. Import Path Changes for Advanced Users

If you were importing internal classes directly, you'll need to update imports:

```python
# Before
from earthaccess.query import GranuleQuery, BoundingBox

# After
from earthaccess.search import GranuleQuery, BoundingBox
# Or use the top-level exports
from earthaccess import GranuleQuery, BoundingBox
```

---

## New Features

### Query Builders

New `GranuleQuery` and `CollectionQuery` classes provide type-safe query
construction with validation:

```python
from earthaccess import GranuleQuery

# Method chaining with validation
query = (
    GranuleQuery()
    .short_name("ATL06")
    .temporal("2023-01-01", "2023-06-30")
    .bounding_box(-180, -90, 180, 90)
    .cloud_hosted(True)
)

# Validate before execution
result = query.validate()
if not result.is_valid:
    print(result.errors)

# Use with search_data
granules = earthaccess.search_data(query=query)

# Convert to STAC format
stac_query = query.to_stac()
```

#### Geometry File Support

Load complex geometries from files with automatic simplification:

```python
query = GranuleQuery().short_name("ATL06").polygon(file="boundary.geojson")
```

The geometry is automatically simplified if it exceeds CMR's point limits.

### Rich HTML Display

Search results now render as formatted HTML in Jupyter notebooks with
interactive pagination:

```python
# Automatic rich display
granules = earthaccess.search_data(short_name="ATL06", count=10)
granules  # Displays as formatted HTML table with pagination controls
```

Navigate through results using First/Previous/Next/Last buttons, and see
both "Total in CMR" and "Loaded" counts in the header.

Individual results also have enhanced display:

```python
granules[0]  # Displays granule card with metadata
```

The `Auth` class also displays authentication status in notebooks:

```python
auth = earthaccess.login()
auth  # Shows login status, strategy, user info (tokens redacted)
```

### Interactive Maps

Visualize spatial extent with interactive maps (requires `[widgets]` extra):

```bash
pip install earthaccess[widgets]
```

```python
# Show map for search results
granules = earthaccess.search_data(short_name="ATL06", count=100)
granules.show_map()

# Show single granule
granules[0].show_map()

# Show collection extent
collections = earthaccess.search_datasets(short_name="ATL06")
collections[0].show_map()
```

### STAC Conversion

Convert between CMR and STAC formats:

```python
# DataGranule to STAC Item
granule = granules[0]
stac_item = granule.to_stac()

# DataCollection to STAC Collection
collection = collections[0]
stac_collection = collection.to_stac()

# Use the stac module directly
from earthaccess.stac import umm_granule_to_stac_item, stac_item_to_data_granule
```

### SearchResults with Lazy Pagination

New `SearchResults` class for efficient iteration over large result sets:

```python
from earthaccess.search import DataGranules, SearchResults

query = DataGranules().short_name("ATL06").temporal("2023-01", "2023-12")
results = SearchResults(query, limit=10000)

# Lazy iteration using items() - pystac-client compatible
for granule in results.items():
    process(granule)

# Or iterate directly
for granule in results:
    process(granule)

# Page-by-page iteration for batch processing (default page size: 2000)
for page in results.pages():
    batch_process(page)

# Custom page size
for page in results.pages(page_size=100):
    batch_process(page)

# Get summary statistics
summary = results.summary()
print(f"Total size: {summary['total_size_mb']:.1f} MB")
```

### Asset Classes

Type-safe handling of granule files:

```python
from earthaccess import Asset, AssetFilter

# Create filter for data files only
filter = AssetFilter(roles=["data"], extensions=[".nc", ".h5"])

# Apply to granule
for asset in granule.assets():
    if asset.matches_filter(filter):
        print(f"Data file: {asset.href}")
```

### Cloud Storage Downloads

Download directly to cloud storage:

```python
from earthaccess import TargetLocation

# Download to S3
target = TargetLocation(
    "s3://my-bucket/earthdata/",
    storage_options={"profile": "my-aws-profile"}
)
files = earthaccess.download(granules, target)

# Download to GCS
target = TargetLocation("gs://my-bucket/earthdata/")
files = earthaccess.download(granules, target)
```

### Virtual Datasets

Enhanced virtual dataset support with multiple parsers:

```python
from earthaccess import open_virtual_dataset

# Automatic parser selection
vds = open_virtual_dataset(granule)

# Specify parser explicitly
vds = open_virtual_dataset(granule, parser="dmrpp")  # or "hdf5", "netcdf3"

# Multi-file datasets
from earthaccess import open_virtual_mfdataset
vds = open_virtual_mfdataset(granules)
```

### Streaming Executor

Memory-efficient parallel processing:

```python
from earthaccess.store.streaming import StreamingExecutor, AuthContext

# Create auth context for distributed workers
auth_ctx = AuthContext.from_auth(earthaccess.__auth__)

# Process with backpressure
with StreamingExecutor(max_workers=4) as executor:
    for result in executor.map(process_granule, granules):
        yield result
```

---

## New Public API

### Classes

| Class | Module | Description |
|-------|--------|-------------|
| `GranuleQuery` | `earthaccess.search` | Query builder for granule searches |
| `CollectionQuery` | `earthaccess.search` | Query builder for collection searches |
| `SearchResults` | `earthaccess.search` | Lazy pagination wrapper |
| `GranuleResults` | `earthaccess.search` | SearchResults subclass returned by `search_data()` |
| `CollectionResults` | `earthaccess.search` | SearchResults subclass returned by `search_datasets()` |
| `Asset` | `earthaccess.store` | Immutable granule file representation |
| `AssetFilter` | `earthaccess.store` | Filter for selecting assets |
| `TargetLocation` | `earthaccess.store` | Cloud storage download target |
| `BoundingBox` | `earthaccess.search` | Spatial bounding box type |
| `DateRange` | `earthaccess.search` | Temporal range type |
| `Point` | `earthaccess.search` | Point geometry type |
| `Polygon` | `earthaccess.search` | Polygon geometry type |

### Methods

| Method | Class | Description |
|--------|-------|-------------|
| `to_stac()` | `DataGranule`, `DataCollection` | Convert to STAC format |
| `to_dict()` | `DataGranule`, `DataCollection` | Convert to dictionary |
| `show_map()` | `DataGranule`, `DataCollection`, `SearchResults` | Display interactive map |
| `summary()` | `SearchResults` | Get aggregated statistics |
| `total()` | `SearchResults` | Get total CMR hits (different from `len()`) |
| `all()` | `SearchResults` | Fetch and return all results as a list |
| `filter()` | `SearchResults` | Filter results by criteria (size, cloud_hosted, etc.) |
| `items()` | `SearchResults` | Iterate through results one at a time (pystac-client compatible) |
| `pages(page_size=2000)` | `SearchResults` | Iterate by pages with configurable page size |
| `doi()` | `DataCollection` | Get DOI string |
| `citation()` | `DataCollection` | Get formatted citation |

### Functions

| Function | Module | Description |
|----------|--------|-------------|
| `open_virtual_dataset()` | `earthaccess.virtual` | Create virtual Zarr dataset |
| `open_virtual_mfdataset()` | `earthaccess.virtual` | Create multi-file virtual dataset |
| `consolidate_metadata()` | `earthaccess.virtual` | Consolidate Kerchunk metadata |
| `has_widget_support()` | `earthaccess.formatting` | Check if widgets available |

---

## Migration Guide

### Updating Import Statements

If you use internal imports, update them as follows:

```python
# Query classes
# Before: from earthaccess.query import GranuleQuery
# After:
from earthaccess import GranuleQuery
# Or: from earthaccess.search import GranuleQuery

# Geometry types
# Before: from earthaccess.query import BoundingBox
# After:
from earthaccess import BoundingBox
# Or: from earthaccess.search import BoundingBox

# DAAC information
# Before: from earthaccess.daac import DAACS
# After:
from earthaccess.store.daac import DAACS
```

### Adding Explicit Login

Add `earthaccess.login()` before any data access operations:

```python
import earthaccess

# Add this line before accessing data
earthaccess.login()

# Now these will work
granules = earthaccess.search_data(short_name="ATL06")
files = earthaccess.open(granules)
```

### Using New Query Builders

The new query builders are optional but recommended:

```python
# Old style (still works)
granules = earthaccess.search_data(
    short_name="ATL06",
    temporal=("2023-01", "2023-06"),
    bounding_box=(-180, -90, 180, 90),
)

# New style (recommended)
from earthaccess import GranuleQuery

query = (
    GranuleQuery()
    .short_name("ATL06")
    .temporal("2023-01", "2023-06")
    .bounding_box(-180, -90, 180, 90)
)
granules = earthaccess.search_data(query=query)
```

---

## Optional Dependencies

### Widgets Extra

For interactive map visualization:

```bash
pip install earthaccess[widgets]
```

Includes: `anywidget`, `lonboard`, `geopandas`, `shapely`

### Virtual Datasets

For virtual dataset functionality:

```bash
pip install earthaccess[virtualizarr]
```

Includes: `virtualizarr`, `h5py`, `zarr`

---

## Package Structure

```
earthaccess/
├── __init__.py          # Public API exports
├── api.py               # Top-level functions (login, search_data, etc.)
├── auth/                # Authentication
│   ├── auth.py          # Auth class
│   ├── credentials.py   # S3Credentials
│   └── system.py        # PROD, UAT systems
├── search/              # Search functionality
│   ├── query/           # Query builders
│   │   ├── granule_query.py
│   │   ├── collection_query.py
│   │   └── types.py     # BoundingBox, DateRange, etc.
│   ├── queries.py       # DataGranules, DataCollections
│   └── results.py       # DataGranule, DataCollection, SearchResults
├── store/               # Data access
│   ├── store.py         # Store class
│   ├── assets.py        # Asset, AssetFilter
│   ├── target.py        # TargetLocation
│   ├── streaming.py     # StreamingExecutor
│   └── download.py      # Download utilities
├── stac/                # STAC conversion
│   └── converters.py    # UMM <-> STAC converters
├── formatting/          # Display utilities
│   ├── html.py          # HTML formatters
│   └── widgets.py       # Interactive maps
├── virtual/             # Virtual datasets
│   ├── dmrpp.py         # VirtualiZarr integration
│   └── kerchunk.py      # Kerchunk utilities
└── exceptions/          # Custom exceptions
```

---

## Testing

This release includes 661+ unit tests covering all new functionality:

```bash
# Run all tests
uv run pytest tests/unit/ -q

# Run with coverage
uv run pytest tests/unit/ --cov=earthaccess
```

---

## Contributors

This release was developed by:

- [@betolink](https://github.com/betolink) - Lead developer
- [@chuckwondo](https://github.com/chuckwondo) - Authentication fixes
- [@ana-sher](https://github.com/ana-sher) - Windows compatibility
- [@Sherwin-14](https://github.com/Sherwin-14) - DataCollection methods

---

## Acknowledgments

Special thanks to the earthaccess community for feedback and testing during
the development of this release.

---

## What's Next

This alpha release is intended for testing and feedback. Please report any
issues at [github.com/nsidc/earthaccess/issues](https://github.com/nsidc/earthaccess/issues).

Planned for 1.0.0 stable:

- Additional STAC catalog integrations
- Enhanced distributed computing support
- Performance optimizations
- Expanded documentation and tutorials

---

## Full Changelog

See [CHANGELOG.md](../../CHANGELOG.md) for the complete list of changes.
